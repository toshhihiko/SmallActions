# 概要

## ジャンル
- アクションゲーム
- ローグライクゲーム
- 教育ゲーム（環境問題）

## システム
- ゲームエンジン：Unity
- 使用言語：C#
- 使用したパッケージ：ML-Agents
- ステップ数：2,194
- ソースコード：https://github.com/toshhihiko/SmallActions-ProjectFolder.git
- プレイ動画：https://youtu.be/2U4AhqsTgTc

## コンセプト
- アクションの強さと環境への影響をトレードオフの関係にしたゲーム
- 強いアクションは環境に悪い影響を与え、弱いアクションは環境に良い影響を与える
- 環境が悪化すると敵も強化されるため、だんだんと敵を倒しづらくなっていく
<img src="https://github.com/toshhihiko/SmallActions/assets/75311651/fa781900-d4dd-430d-b716-8fadc7f2d5f8" width="300">

# 遊び方

## 始め方
- 本プロジェクトをダウンロード
- zipファイルを解凍し、「Prototype-1」を起動
- 画面起動後、「START」ボタンをクリック
<img src="https://github.com/toshhihiko/SmallActions/assets/75311651/6e41f7e8-8bdd-46eb-8dc4-88ba31b5e774" width="300">

## 操作方法
- 移動：←(A)↑(W)→(D)↓(S)
- 攻撃：マウスカーソルで方向、右クリックで攻撃
- 装備：武器アイテムを右下の六角形にドラッグ＆ドロップ、左Shiftキーで持ち替え
- 取得：パーツ、自然、食料などのアイテムを右上の丸型にドラッグ＆ドロップ
- 充電：最初のステージの左上にある充電所の♺アイコンをクリック（使用中バッテリーと充電中バッテリーが交換される）
- 発電：最初のステージの左上にある発電所をクリックして切り替える（発電方法が風力⇔火力に切り替わる、充電速度とCO2排出量が変わる）
- 植林：最初のステージの右上にある畑に自然アイテム（種と水）をドラッグ＆ドロップ（CO2が吸収され減少する）
- 収納：最初のステージの中心にある箱にパーツと食べ物をドラッグ＆ドロップ（回復、強化アイテムがストックされる）
- 修理：最初のステージの中心にある博士の♡MAXをクリック（プレイヤーの体力が全回復する）
- 強化：最初のステージの中心にある博士の♡+10をクリック（プレイヤーの体力上限が10増える）

# 工夫した点

## 強化学習
- ML-Agentsを活用してラスボスの行動モデルを強化学習して作成
- 学習方法：セルフプレイ（ラスボスとプレイヤーキャラクターを戦わせながら交互に学習する方法）
  - 観察：Raycast Observation(360度全方向に光線を射出して敵と壁の位置を取得）、武器の方向、攻撃可能か否か
  - 行動：移動方向（武器の方向は移動方向に合わせる）、攻撃
  - 報酬：攻撃をヒット(+0.1)、相手を撃破(+1.0)、攻撃を受ける(-0.1)、相手に撃破される（-1.0)
<img src="https://github.com/toshhihiko/SmallActions/assets/75311651/eb2f0a6a-ad5e-4d6f-a710-dea55e1e16e1" width="300">

## ランダムマップ
- ゲームをプレイするたびに、ステージマップ間の通路がランダムに接続・切断されるよう設計
- （作った後に「穴掘り法」と類似していることに気づいた、車輪の再発明だった）
- 設定した条件は以下の２つ
  - ステージからゴールまで、最低でも１つの道がつながっていること
  - すべてのステージに、アクセス可能なこと
1. 最上層のステージの中からスタートステージを、最下層のステージの中からゴールステージを、それぞれ１つずつランダムに選択
2. スタートステージからランダムにパスを選択しながら、ゴールステージにたどり着くまで繰り返す
3. スタートステージとゴールステージに１本のパスができたら、まだ通過していないステージの中からスタートステージを、すでに通過ステージをゴールステージに再設定
4. すべてのステージが通過されるまで、２と３を繰り返す
<img src="https://github.com/toshhihiko/SmallActions/assets/75311651/8b137b46-d9e9-40a0-8850-d47c132a855e" width="1200">

## インターフェース
- 武器の装備をインターフェースを使って再利用できるように設計
- ９種類のそれぞれの武器にクラスを作成し、共通のインターフェースを実装
- プレイヤーとエネミーの両方が同じ武器にアクセスできるように設定
